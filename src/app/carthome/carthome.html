<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
  <a class="navbar-brand fw-bold text-white" href="#">MyShop</a>

  <div class="collapse navbar-collapse">
    <ul class="navbar-nav me-auto"></ul>
    <div class="d-flex align-items-center">
      <!-- Changed routerLink to /cart -->
      <a routerLink="/addedcart" class="text-white position-relative me-3">
        <i class="bi bi-cart4 fs-4"></i>
        <!-- Cart Count Badge -->
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger cart-badge">
          {{ cartCount }}
        </span>
      </a>
    </div>
  </div>
</nav>

<!-- Product Grid -->
<div class="container py-4">
  <div class="row g-3">

    <!-- Product Card -->
    <div class="col-md-4" *ngFor="let product of products">
      <div class="card p-2 h-100 shadow-sm rounded-3">
        <div class="d-flex align-items-center">

          <!-- Product Image -->
          <div class="flex-shrink-0 me-3" style="width: 80px;">
            <a [routerLink]="'/product/' + product.slug + '/' + product.id">
              <img [src]="product.image" class="img-fluid" [alt]="product.name" [title]="product.name">
            </a>
          </div>

          <!-- Product Info -->
          <div class="flex-grow-1">
            <h6 class="mb-1">
              <a [routerLink]="'/product/' + product.slug + '/' + product.id" class="text-dark">
                {{ product.name }}
              </a>
            </h6>
            <p class="mb-1 fw-500">₹{{ product.price }}</p>

            <!-- Sizes -->
            <div class="d-flex align-items-center gap-2 mb-1">
              <span *ngFor="let size of product.sizes" class="btn btn-sm"
                    [ngClass]="{'btn-dark': size === product.selectedSize, 'btn-outline-dark': size !== product.selectedSize}"
                    (click)="selectSize(product, size)">
                {{ size }}
              </span>
            </div>

 <!-- Add to Cart OR Quantity Selector -->
<div *ngIf="!product.quantity || product.quantity === 0; else qtySelector">
  <button class="btn btn-dark btn-sm w-100 stylish-btn" (click)="addToCart(product)">
    <i class="bi bi-cart-plus"></i> ADD TO CART
  </button>
</div>

<!-- Quantity Selector -->
<ng-template #qtySelector>
  <div class="quantity-controls d-flex align-items-center justify-content-between">
    <button class="qty-btn" (click)="decreaseQty(product)">−</button>
    <span class="qty-value mx-2">{{ product.quantity }}</span>
    <button class="qty-btn" (click)="increaseQty(product)">+</button>
  </div>
</ng-template>

          </div>
        </div>
      </div>
    </div>

  </div>
</div>